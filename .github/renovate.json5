{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:recommended",
    "docker:enableMajor",
    ":dependencyDashboard",
    ":semanticCommits"
  ],
  // Target develop as the integration branch -- all dependency
  // updates land here first so we can test before promoting to main.
  "baseBranches": ["develop"],
  // Squash-merge auto-merged PRs for clean commit history on develop
  "automergeStrategy": "squash",
  // Branch naming
  "branchPrefix": "renovate/",
  // Commit message format (semantic commits)
  "semanticCommits": "enabled",
  "semanticCommitType": "chore",
  "semanticCommitScope": "deps",
  // PR settings
  "prHourlyLimit": 5,
  "prConcurrentLimit": 10,
  // Stability settings
  "minimumReleaseAge": "3 days",
  "internalChecksFilter": "strict",
  // Labels for PRs
  "labels": ["dependencies"],
  // Ignore paths
  "ignorePaths": [
    "**/node_modules/**",
    "**/__pycache__/**",
    "**/venv/**",
    "**/.venv/**"
  ],
  // Timezone for scheduling
  "timezone": "America/Chicago",
  // Schedule for updates (weekdays during work hours)
  "schedule": ["after 9am and before 5pm every weekday"],
  // Vulnerability alerts get priority
  "vulnerabilityAlerts": {
    "enabled": true,
    "labels": ["security", "dependencies"],
    "minimumReleaseAge": "0 days"
  },
  // Package rules
  "packageRules": [
    // Auto-merge patch and minor updates into develop via PR.
    // Branch protection requires PRs, so automergeType must be "pr".
    // develop is the testing ground -- we verify before promoting to main.
    {
      "description": "Auto-merge patch and minor updates",
      "matchUpdateTypes": ["patch", "minor"],
      "automerge": true,
      "automergeType": "pr",
      "matchPackagePatterns": ["*"]
    },
    // Auto-merge digest updates (container images)
    {
      "description": "Auto-merge digest updates",
      "matchUpdateTypes": ["digest"],
      "automerge": true,
      "automergeType": "pr"
    },
    // Auto-merge lockfile maintenance
    {
      "description": "Auto-merge lockfile maintenance",
      "matchUpdateTypes": ["lockFileMaintenance"],
      "automerge": true,
      "automergeType": "pr"
    },
    // Require manual review for major updates (can be breaking)
    {
      "description": "Require manual review for major updates",
      "matchUpdateTypes": ["major"],
      "automerge": false,
      "labels": ["dependencies", "major"]
    },
    // Group Python dependencies
    {
      "description": "Group Python dependencies",
      "matchManagers": ["pip_requirements", "pip-compile", "poetry", "pep621"],
      "groupName": "Python dependencies"
    },
    // Group Node.js dependencies
    {
      "description": "Group Node.js type definitions",
      "matchPackagePatterns": ["@types/*"],
      "groupName": "TypeScript type definitions"
    },
    // Group ESLint
    {
      "description": "Group ESLint dependencies",
      "matchPackagePatterns": ["eslint", "@eslint/*", "eslint-*"],
      "groupName": "ESLint"
    },
    // Group testing libraries
    {
      "description": "Group testing libraries",
      "matchPackagePatterns": ["jest", "@jest/*", "vitest", "@vitest/*", "testing-library", "@testing-library/*"],
      "groupName": "Testing libraries"
    }
  ]
}
